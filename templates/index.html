<!-- This is the template for the index page, containing the data to be
     sent to the invoice. Fields are defined in html.py -->
{% extends "layout.html" %}
{% block body %}

<script src="http://maps.google.com/maps/api/js"></script>

<!-- Get coordinates and generate Google map -->
<script>
  x = navigator.geolocation;
  x.getCurrentPosition(success, failure);
  function success(position)
  {
    // save coordiates for later
    var lat = position.coords.latitude;
    var long = position.coords.longitude;

    // update hidden input form value
    $('#latitude').val(lat);
    $('#longitude').val(long);
    var current_date = new Date();
    $('#date').val(current_date.getMonth()+1+"/"+current_date.getDate()+"/"+current_date.getFullYear());
    $('#time').val(current_date.getHours()+":"+current_date.getMinutes());


    
    // Google ready coordinates
    var coords = new google.maps.LatLng(lat, long);

    // set options for map (max zoom = 20)
    var mapOptions = {
      zoom: 16,
      center: coords,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }

    // create map with marker at coordinates
    var map = new google.maps.Map(document.getElementById("map"), mapOptions);
    var marker = new google.maps.Marker({map: map, position: coords});
  }
  function failure()
  {
    return;
  }
</script>

<style>
#map {
  width:100%;
  height:400px;
}
</style>

<div class="container">
	<form method='post' action="{{ url_for('submit_form') }}">

		<!-- Introduction -->
		<div class="panel panel-default">
		  <div class="panel-heading">
		  	<h3>Tampa/Hillsborough Continuum of Care | Point in Time (PIT) Survey</h3>
		  </div>
		  <div class="panel-body">
		  	<div class="row">
			  	<div class="col-md-3">
				  	<p>Hello, my name is <input type="text" class="form-control input-sm" name="volunteer"/></p>
			  	</div>
			  	<div class="col-md-9">
				  	Iâ€™m a volunteer for the Tampa/Hillsborough Continuum of Care.  We are conducting a survey to count homeless people to provide better services to them in our community.  Your participation is voluntary and your responses will not be shared with anyone outside of our team.  I need to read each question all the way through.  May I have a few minutes of your time?	
			  		If the person declines to participate please gather as much identifying/descriptive info as possible on the observation survey.
			  	</div>
		  	</div>
		  </div>
		</div>

		<!-- General information block -->
		<p class="lead"><span class="glyphicon glyphicon-info-sign"></span>General Information</p>
		<div class="well">
			<div class="row">
				{% for item in general_inputs.inputs %}
					<div class="col-md-3">
						<b>{{loop.index}}. {{ item.label }}</b>
						<input type="text" class="form-control input-sm" name="{{ item.id }}"/>
				  	</div>
				{% endfor %}
			</div>
		</div>
		<p>
	
		<!-- Questions -->
		<div class="well">
			<div class="row">
			{% for question in general_inputs.questions %}
				<div class="col-md-12">
				    <b>{{loop.index}}. {{ question.label }}</b>
					<div class="input-group">
						  <div class="input-group-btn">
						  <div class="btn-group" data-toggle="buttons">
							 {% for input in question.inputs %}
								  <label class="btn btn-primary">
									<input type="radio" id="{{ input.id }}" autocomplete="off"> {{ input.label }}
								  </label>
							 {% endfor %}
						  </div>
						  </div>
					  <input type="text" class="form-control" id="{{ question.other_id }}" disabled>
					</div>
			  	</div>
			{% endfor %}
			</div>
		</div>
		
		<!-- Stop Sign -->
		<div class="row alert alert-info">
		<div class="col-md-3">
			<center>
			<img src="stop.png" alt="Stop sign" style="width:50px;height:50px;">
			<h4>Stop Survey</h4>
			</center>
		</div>
		<div class="col-md-9">
		  <h4>If a person reports they are living in a non-homeless situation.  Examples include:  Rental apartment/home, staying or living with friends or family, permanent supportive housing, long term care or nursing home, residential project or halfway house, or hotel/motel paid for by self.</h4>
		</div>
		</div>

		<!--- Google Maps divider -->
		<p class="lead"><span class="glyphicon glyphicon-map-marker"></span>Map Location</p>
		<div class="well">
			<div id="map"></div>
		</div>
		<input type="hidden" name="latitude" id="latitude">
		<input type="hidden" name="longitude" id="longitude">
		<input type="hidden" name="date" id="date">
		<input type="hidden" name="time" id="time">

		<!-- Submit -->
		<p class="lead"><span class="glyphicon glyphicon-check"></span>Submit</p>
		<div class="well">
			<div class="row">
				<div class="col-md-12">
					<button type="submit" class="btn fit-width btn-primary">Submit Information</button> 
				</div> 
			</div>
		</div>
	</form>
</div>
{% endblock %}

